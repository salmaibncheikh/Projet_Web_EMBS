==================================================
üöÄ Full Analysis Flow Log
üïí Started at: 2025-12-05_02-38-46
==================================================

===========================================================================================================================================================
‚ñ∂ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\emotional_classification\run_yolo_EMCLS.py
===========================================================================================================================================================
[INFO] Loading YOLO model...
[INFO] Checking for input image...
[INFO] Input image found: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\0_BE_input\original_input.png
[INFO] Running classification...
[INFO] Creating probability plot...
[INFO] Saving results to shared memory...
[INFO] Emotion JSON saved ‚Üí C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\1_EC_out\EC_result.json
[SUCCESS] Emotion classification process completed.
[EXIT CODE] 0
‚úÖ Finished: run_yolo_EMCLS


================================================================================================================================================
‚ñ∂ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\object_detection\run_OBJ_DET.py
================================================================================================================================================
YOLO11s summary (fused): 100 layers, 9,413,961 parameters, 0 gradients, 21.3 GFLOPs
[SAVE] Processed image copied to: C:\shared_memory\2_OBJ_DET_out\processed_input.png
[RUN] YOLO detection on: temp\processed_input.png
[INFO] 2 object(s) detected.
[SAVED] 8511_house ‚Üí colored
[SAVED] 6646_tree ‚Üí colored
[RUN] YOLO detection on: C:\shared_memory\0_BE_input\original_input.png
[INFO] 1 object(s) detected.
[SAVED] 3191_house ‚Üí colored
[SAVE] Plots copied to: C:\shared_memory\2_OBJ_DET_out\plots
[CLEAN] Temporary folder removed.
[DONE] Object detection pipeline complete.
[EXIT CODE] 0
‚úÖ Finished: run_OBJ_DET


========================================================================================================================================================
‚ñ∂ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\facial_expressions_detection\run_FED.py
========================================================================================================================================================
[INFO] Starting facial expression detection pipeline...
[INFO] Loading model...
[INFO] Running detection...

image 1/1 C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\facial_expressions_detection\..\shared_memory\0_BE_input\original_input.png: 480x640 3 happy_faces, 407.7ms
Speed: 4.5ms preprocess, 407.7ms inference, 2.4ms postprocess per image at shape (1, 3, 480, 640)
[INFO] Filtering results...
[INFO] 3 facial expressions detected.
[INFO] Saving detections to JSON...
[INFO] Generating diagnostic plots...
[INFO] Cropping expression regions...
[INFO] Saved 3 facial crops to C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\facial_expressions_detection\temp\crops
[INFO] Saving all outputs to shared memory...
[INFO] Shared memory updated at C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\3_FED_out\facial_expressions
[INFO] Facial expression detection pipeline completed successfully.
[INFO] Cleaning temp directory...
[EXIT CODE] 0
‚úÖ Finished: run_FED


============================================================================================================================================
‚ñ∂ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\colors_extractor\run_CEX.py
============================================================================================================================================
C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\colors_extractor\models\plot_color_emotions.py:100: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax = plt.subplots(figsize=(6, 5))
C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\colors_extractor\models\plot_color_emotions.py:109: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, axs = plt.subplots(1, 2, figsize=(14, 6))
C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\colors_extractor\models\plot_color_emotions.py:63: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, ax = plt.subplots(figsize=(6, fig_height))
[INFO] Starting color extraction pipeline (CEX)...
[INFO] Processing original drawing...
[INFO] Processing object crops...
[INFO] Processing facial expression crops...
[WARN] Facial crops directory does not exist: C:\shared_memory\3_FED_out\facial_expressions\crops
[INFO] Saving results to shared memory...
[INFO] Shared memory updated at C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\4_CEX_out\colors
[INFO] Cleaning up temp directory...
[INFO] Color extraction pipeline completed successfully.
[EXIT CODE] 0
‚úÖ Finished: run_CEX


=========================================================================================================================================
‚ñ∂ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\run_JB_A.py
=========================================================================================================================================
==================================================
Running JSON Builder - Part A
==================================================

Running: json_builder/get_data_from_shared.py
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\1_EC_out\EC_result.json
[WARN] Missing object detection JSONs: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\2_OBJ_DET_out\objects\colored\jsons
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\3_FED_out\facial_expressions\expressions.json
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\4_CEX_out\colors\JSON\drawing_results.json
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\4_CEX_out\colors\JSON\object_results.json
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\4_CEX_out\colors\JSON\facial_expression_results.json
{
    "drawing_image_path": "C:\\Users\\MSI\\Desktop\\projet_web\\embs\\v0-mother-health-app-main\\backend\\emotional_classification\\shared_memory\\0_BE_input\\original_input.png",
    "drawing_bw_image_path": "C:\\Users\\MSI\\Desktop\\projet_web\\embs\\v0-mother-health-app-main\\backend\\emotional_classification\\shared_memory\\0_BE_input\\original_input_BW.png",
    "emotional_classification": {},
    "object_detection": {},
    "facial_expressions": {},
    "color_extraction": {
        "drawing": {},
        "objects": {},
        "expressions": {}
    }
}

[DONE] json_builder/get_data_from_shared.py

Running: json_builder/build_pre_analysis_format.py
[INFO] Building pre-analysis format...
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\1_EC_out\EC_result.json
[WARN] Missing object detection JSONs: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\2_OBJ_DET_out\objects\colored\jsons
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\3_FED_out\facial_expressions\expressions.json
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\4_CEX_out\colors\JSON\drawing_results.json
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\4_CEX_out\colors\JSON\object_results.json
[WARN] Missing: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\shared_memory\4_CEX_out\colors\JSON\facial_expression_results.json
[INFO] Pre-analysis JSON saved to: C:\shared_memory\5_JSON_out\pre_analysis.json
[INFO] Validating pre-analysis JSON against schema...
[INVALID] pre_analysis.json failed validation:
None is not of type 'number'

[DONE] json_builder/build_pre_analysis_format.py
[EXIT CODE] 0
‚úÖ Finished: run_JB_A


=============================================================================================================================================
‚ñ∂ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\analysis_generator\run_AG.py
=============================================================================================================================================
Running Analysis Generator...
[INFO] Analysis JSON saved to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\6_AG_out\analysis_text.json
# Emotional Analysis
**Main Emotion:** **unknown**
## Scene
You can sense a **unknown** (0.000) atmosphere here.
## Objects
## Facial Expressions
[INFO] JSON summary saved to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\6_AG_out\analysis_text.json

Analysis Generator finished.
[EXIT CODE] 0
‚úÖ Finished: run_AG


=========================================================================================================================================
‚ñ∂ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\run_JB_B.py
=========================================================================================================================================
==================================================
Running JSON Builder - Part B
==================================================

Running: json_builder/build_post_analysis_format.py
[INFO] Building post-analysis format...
Traceback (most recent call last):
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\build_post_analysis_format.py", line 68, in <module>
    main()
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\build_post_analysis_format.py", line 48, in main
    pre = load_json(PRE_PATH)
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\build_post_analysis_format.py", line 41, in load_json
    raise FileNotFoundError(f"Missing file: {path}")
FileNotFoundError: Missing file: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\5_JSON_out\pre_analysis.json

[ERROR] Script failed: json_builder/build_post_analysis_format.py
Traceback (most recent call last):
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\run_JB_B.py", line 77, in <module>
    run_json_builder_part_b()
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\run_JB_B.py", line 72, in run_json_builder_part_b
    run_script(step)
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\run_JB_B.py", line 61, in run_script
    raise RuntimeError(f"Script failed: {script_path}")
RuntimeError: Script failed: json_builder/build_post_analysis_format.py
[EXIT CODE] 1
‚ùå Error in run_JB_B
