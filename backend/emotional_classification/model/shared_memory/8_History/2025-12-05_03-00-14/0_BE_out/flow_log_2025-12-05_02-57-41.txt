==================================================
ðŸš€ Full Analysis Flow Log
ðŸ•’ Started at: 2025-12-05_02-57-41
==================================================

===========================================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\emotional_classification\run_yolo_EMCLS.py
===========================================================================================================================================================
[INFO] Loading YOLO model...
[INFO] Checking for input image...
[INFO] Input image found: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\0_BE_input\original_input.png
[INFO] Running classification...
[INFO] Creating probability plot...
[INFO] Saving results to shared memory...
[INFO] Emotion JSON saved â†’ C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\1_EC_out\EC_result.json
[SUCCESS] Emotion classification process completed.
[EXIT CODE] 0
âœ… Finished: run_yolo_EMCLS


================================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\object_detection\run_OBJ_DET.py
================================================================================================================================================
YOLO11s summary (fused): 100 layers, 9,413,961 parameters, 0 gradients, 21.3 GFLOPs
[INFO] Looking for input image in: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\0_BE_input
[INFO] INPUT_DIR exists: True
[INFO] Found 1 PNG files: ['original_input.png']
[INFO] Using input image: original_input.png
[SAVE] Processed image copied to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\2_OBJ_DET_out\processed_input.png
[RUN] YOLO detection on: temp\processed_input.png
[INFO] 2 object(s) detected.
[SAVED] 5773_house â†’ colored
[SAVED] 2087_tree â†’ colored
[RUN] YOLO detection on: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\0_BE_input\original_input.png
[INFO] 1 object(s) detected.
[SAVED] 7500_house â†’ colored
[SAVE] Plots copied to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\2_OBJ_DET_out\plots
[CLEAN] Temporary folder removed.
[DONE] Object detection pipeline complete.
[EXIT CODE] 0
âœ… Finished: run_OBJ_DET


========================================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\facial_expressions_detection\run_FED.py
========================================================================================================================================================
[INFO] Starting facial expression detection pipeline...
[INFO] Loading model...
[INFO] Running detection...

image 1/1 C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\facial_expressions_detection\..\shared_memory\0_BE_input\original_input.png: 480x640 3 happy_faces, 153.2ms
Speed: 2.3ms preprocess, 153.2ms inference, 1.2ms postprocess per image at shape (1, 3, 480, 640)
[INFO] Filtering results...
[INFO] 3 facial expressions detected.
[INFO] Saving detections to JSON...
[INFO] Generating diagnostic plots...
[INFO] Cropping expression regions...
[INFO] Saved 3 facial crops to C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\facial_expressions_detection\temp\crops
[INFO] Saving all outputs to shared memory...
[INFO] Shared memory updated at C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\3_FED_out\facial_expressions
[INFO] Facial expression detection pipeline completed successfully.
[INFO] Cleaning temp directory...
[EXIT CODE] 0
âœ… Finished: run_FED


============================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\colors_extractor\run_CEX.py
============================================================================================================================================
[INFO] Starting color extraction pipeline (CEX)...
[INFO] Processing original drawing...
[INFO] Processing object crops...
[INFO] Processing facial expression crops...
[INFO] Saving results to shared memory...
[INFO] Shared memory updated at C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\4_CEX_out\colors
[INFO] Cleaning up temp directory...
[INFO] Color extraction pipeline completed successfully.
[EXIT CODE] 0
âœ… Finished: run_CEX


=========================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\run_JB_A.py
=========================================================================================================================================
==================================================
Running JSON Builder - Part A
==================================================

Running: json_builder/get_data_from_shared.py
[VALID] EC_result.json is valid against EC_json_scheme.json
[VALID] 2087_tree.json is valid against OBJ_DET_json_scheme.json
[VALID] 5773_house.json is valid against OBJ_DET_json_scheme.json
[VALID] 7500_house.json is valid against OBJ_DET_json_scheme.json
[VALID] expressions.json is valid against FED_json_scheme.json
[VALID] drawing_results.json is valid against CEX_list_scheme.json
[VALID] object_results.json is valid against CEX_dict_scheme.json
[VALID] facial_expression_results.json is valid against CEX_dict_scheme.json
{
    "drawing_image_path": "C:\\Users\\MSI\\Desktop\\projet_web\\embs\\v0-mother-health-app-main\\backend\\emotional_classification\\model\\shared_memory\\0_BE_input\\original_input.png",
    "drawing_bw_image_path": "C:\\Users\\MSI\\Desktop\\projet_web\\embs\\v0-mother-health-app-main\\backend\\emotional_classification\\model\\shared_memory\\0_BE_input\\original_input_BW.png",
    "emotional_classification": {
        "label": "Fear",
        "confidence": 0.5142321586608887
    },
    "object_detection": {
        "2087_tree": {
            "label": "tree",
            "confidence": 0.6037648320198059,
            "bbox": {
                "x1": 173.45689392089844,
                "y1": 165.3666229248047,
                "x2": 282.1626281738281,
                "y2": 317.8764953613281
            },
            "position": "bottom-center",
            "size": "medium",
            "id": "2087_tree",
            "crop_path": "C:/Users/MSI/Desktop/projet_web/embs/v0-mother-health-app-main/backend/emotional_classification/model/shared_memory/2_OBJ_DET_out/objects/colored/crops/2087_tree.png"
        },
        "5773_house": {
            "label": "house",
            "confidence": 0.6997544765472412,
            "bbox": {
                "x1": 58.51708221435547,
                "y1": 96.16211700439453,
                "x2": 142.7501678466797,
                "y2": 191.99554443359375
            },
            "position": "top-left",
            "size": "medium",
            "id": "5773_house",
            "crop_path": "C:/Users/MSI/Desktop/projet_web/embs/v0-mother-health-app-main/backend/emotional_classification/model/shared_memory/2_OBJ_DET_out/objects/colored/crops/5773_house.png"
        },
        "7500_house": {
            "label": "house",
            "confidence": 0.7717625498771667,
            "bbox": {
                "x1": 56.90652084350586,
                "y1": 94.0113296508789,
                "x2": 142.52377319335938,
                "y2": 198.065185546875
            },
            "position": "top-left",
            "size": "medium",
            "id": "7500_house",
            "crop_path": "C:/Users/MSI/Desktop/projet_web/embs/v0-mother-health-app-main/backend/emotional_classification/model/shared_memory/2_OBJ_DET_out/objects/colored/crops/7500_house.png"
        }
    },
    "facial_expressions": [
        {
            "label": "happy_face",
            "bbox": [
                399.20416259765625,
                128.72467041015625,
                440.9651794433594,
                166.31626892089844
            ],
            "confidence": 0.8681818246841431
        },
        {
            "label": "happy_face",
            "bbox": [
                186.5631103515625,
                184.88168334960938,
                233.9111785888672,
                223.57655334472656
            ],
            "confidence": 0.8257154226303101
        },
        {
            "label": "happy_face",
            "bbox": [
                300.7534484863281,
                223.85867309570312,
                339.7265930175781,
                249.1231231689453
            ],
            "confidence": 0.6300798058509827
        }
    ],
    "color_extraction": {
        "drawing": [
            {
                "color_name": "gray",
                "rgb": [
                    94,
                    158,
                    165
                ],
                "emotion": "Sadness",
                "proportion": 5418
            },
            {
                "color_name": "yellow",
                "rgb": [
                    226,
                    224,
                    68
                ],
                "emotion": "Happiness",
                "proportion": 3056
            },
            {
                "color_name": "green",
                "rgb": [
                    40,
                    105,
                    74
                ],
                "emotion": "Calm",
                "proportion": 2722
            },
            {
                "color_name": "pink",
                "rgb": [
                    186,
                    195,
                    195
                ],
                "emotion": "Happiness",
                "proportion": 6429
            }
        ],
        "objects": {
            "2087_tree": [
                {
                    "color_name": "gray",
                    "rgb": [
                        115,
                        154,
                        119
                    ],
                    "emotion": "Sadness",
                    "proportion": 161,
                    "is_unusual": false
                },
                {
                    "color_name": "yellow",
                    "rgb": [
                        240,
                        240,
                        27
                    ],
                    "emotion": "Happiness",
                    "proportion": 589,
                    "is_unusual": false
                },
                {
                    "color_name": "pink",
                    "rgb": [
                        184,
                        194,
                        193
                    ],
                    "emotion": "Happiness",
                    "proportion": 680,
                    "is_unusual": true
                }
            ],
            "5773_house": [
                {
                    "color_name": "pink",
                    "rgb": [
                        235,
                        183,
                        211
                    ],
                    "emotion": "Happiness",
                    "proportion": 676,
                    "is_unusual": false
                },
                {
                    "color_name": "pink",
                    "rgb": [
                        217,
                        132,
                        169
                    ],
                    "emotion": "Happiness",
                    "proportion": 731,
                    "is_unusual": false
                }
            ],
            "7500_house": [
                {
                    "color_name": "pink",
                    "rgb": [
                        233,
                        187,
                        211
                    ],
                    "emotion": "Happiness",
                    "proportion": 749,
                    "is_unusual": false
                },
                {
                    "color_name": "pink",
                    "rgb": [
                        224,
                        134,
                        164
                    ],
                    "emotion": "Happiness",
                    "proportion": 786,
                    "is_unusual": false
                },
                {
                    "color_name": "brown",
                    "rgb": [
                        187,
                        60,
                        61
                    ],
                    "emotion": "Calm",
                    "proportion": 432,
                    "is_unusual": false
                }
            ]
        },
        "expressions": {
            "happy_face_1": [
                {
                    "color_name": "pink",
                    "rgb": [
                        191,
                        155,
                        172
                    ],
                    "emotion": "Happiness",
                    "proportion": 76
                },
                {
                    "color_name": "gray",
                    "rgb": [
                        158,
                        101,
                        121
                    ],
                    "emotion": "Sadness",
                    "proportion": 128
                }
            ],
            "happy_face_2": [
                {
                    "color_name": "purple",
                    "rgb": [
                        113,
                        36,
                        82
                    ],
                    "emotion": "Fear",
                    "proportion": 27
                },
                {
                    "color_name": "pink",
                    "rgb": [
                        187,
                        133,
                        163
                    ],
                    "emotion": "Happiness",
                    "proportion": 55
                },
                {
                    "color_name": "gray",
                    "rgb": [
                        169,
                        108,
                        140
                    ],
                    "emotion": "Sadness",
                    "proportion": 63
                },
                {
                    "color_name": "pink",
                    "rgb": [
                        215,
                        171,
                        197
                    ],
                    "emotion": "Happiness",
                    "proportion": 32
                }
            ],
            "happy_face_3": [
                {
                    "color_name": "purple",
                    "rgb": [
                        139,
                        76,
                        97
                    ],
                    "emotion": "Fear",
                    "proportion": 54
                },
                {
                    "color_name": "pink",
                    "rgb": [
                        216,
                        166,
                        181
                    ],
                    "emotion": "Happiness",
                    "proportion": 33
                }
            ]
        }
    }
}

[DONE] json_builder/get_data_from_shared.py

Running: json_builder/build_pre_analysis_format.py
[INFO] Building pre-analysis format...
[VALID] EC_result.json is valid against EC_json_scheme.json
[VALID] 2087_tree.json is valid against OBJ_DET_json_scheme.json
[VALID] 5773_house.json is valid against OBJ_DET_json_scheme.json
[VALID] 7500_house.json is valid against OBJ_DET_json_scheme.json
[VALID] expressions.json is valid against FED_json_scheme.json
[VALID] drawing_results.json is valid against CEX_list_scheme.json
[VALID] object_results.json is valid against CEX_dict_scheme.json
[VALID] facial_expression_results.json is valid against CEX_dict_scheme.json
[INFO] Pre-analysis JSON saved to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\5_JSON_out\pre_analysis.json
[INFO] Validating pre-analysis JSON against schema...
[VALID] pre_analysis.json is valid against pre_analysis_scheme.json

[DONE] json_builder/build_pre_analysis_format.py
[EXIT CODE] 0
âœ… Finished: run_JB_A


=============================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\analysis_generator\run_AG.py
=============================================================================================================================================
Running Analysis Generator...
[INFO] Analysis JSON saved to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\6_AG_out\analysis_text.json
# Emotional Analysis
**Main Emotion:** **fear**
## Scene
Thereï¿½s a sense of **fear**, enhanced by  tones.
The use of **gray** gives a **numb** feeling.
With a lot of **yellow**, the mood becomes **spirited**.
The choice of **green** likely connects to a **tranquil** tone.
This **pink** color brings out something **innocent**.
## Objects
### 2087_tree
Its presence brings a sense of **growth**.
Its coloring feels **numb** and organic.
The medium size tree feels **balanced**.
In the bottom center, it roots the scene with a **rooted and central** sense.
### 5773_house
The house may symbolize **memory**.
The house is depicted in a **affectionate** manner.
This medium-sized house gives a **balanced** presence.
A house drawn at the top-left projects **elevated and nostalgic** and **superior**.
### 7500_house
This home-like shape evokes a sense of **safety**.
Its colors create a **innocent** impression of familiarity.
This medium-sized house gives a **settled** presence.
A house drawn at the top-left projects **elevated and nostalgic** and **superior**.
## Facial Expressions
### expr_888289d2
This smile radiates something **delighted**.
### expr_37f25254
A happy expression shines with a **smiling** feeling.
### expr_883b26cd
This smile radiates something **delighted**.
[INFO] JSON summary saved to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\6_AG_out\analysis_text.json

Analysis Generator finished.
[EXIT CODE] 0
âœ… Finished: run_AG


=========================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\json_builder\run_JB_B.py
=========================================================================================================================================
==================================================
Running JSON Builder - Part B
==================================================

Running: json_builder/build_post_analysis_format.py
[INFO] Building post-analysis format...
[INFO] Post-analysis JSON saved to: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\5_JSON_out\post_analysis.json

[DONE] Script completed: json_builder/build_post_analysis_format.py
[EXIT CODE] 0
âœ… Finished: run_JB_B


==========================================================================================================================================
â–¶ Running: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\run_PDFG.py
==========================================================================================================================================
==================================================
       Starting PDF Generation Segment
==================================================

Running with .venv Python: build_sources_folder.py

[DONE] build_sources_folder.py completed successfully

Running with .venv Python: build_full_report.py
PAGES_DIR: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\7_PDFG_out
ASSETS: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\assets
bASE_DIR: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator
shared: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory

========== OBJECT ID COMPARISON ==========

Object ID: 2087
Expected crop key: OBJDET_crop_2087
Expected plot key: CEX_object_2087
Actual crop path: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\OBJDET\objects\images\OBJDET_2087_tree.png
Actual plot path: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\CEX\objects\plots\CEX_object_2087_tree.png

Object ID: 5773
Expected crop key: OBJDET_crop_5773
Expected plot key: CEX_object_5773
Actual crop path: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\OBJDET\objects\images\OBJDET_5773_house.png
Actual plot path: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\CEX\objects\plots\CEX_object_5773_house.png

Object ID: 7500
Expected crop key: OBJDET_crop_7500
Expected plot key: CEX_object_7500
Actual crop path: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\OBJDET\objects\images\OBJDET_7500_house.png
Actual plot path: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\CEX\objects\plots\CEX_object_7500_house.png

========== EXPRESSION ID COMPARISON ==========

[BUILD] Expression happy_face_1 ? Crop: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\FED\expressions\images\FED_happy_face_1.png, Plot: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\CEX\expressions\plots\CEX_expression_happy_face_1.png
[BUILD] Expression happy_face_2 ? Crop: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\FED\expressions\images\FED_happy_face_2.png, Plot: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\CEX\expressions\plots\CEX_expression_happy_face_2.png
[BUILD] Expression happy_face_3 ? Crop: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\FED\expressions\images\FED_happy_face_3.png, Plot: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources\CEX\expressions\plots\CEX_expression_happy_face_3.png
[WARNING] Ghostscript not found - skipping compression: Ghostscript executable not found at external_tools/gs9-55/bin/gswin64c.exe
[INFO] Uncompressed PDF saved: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\shared_memory\7_PDFG_out\full_analysis_report.pdf
Traceback (most recent call last):
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\build_full_report.py", line 265, in <module>
    run()
  File "C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\build_full_report.py", line 261, in run
    print(f"\u2705 Final PDF saved at: {final_pdf}")
  File "C:\Users\MSI\AppData\Local\Programs\Python\Python310\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\u2705' in position 0: character maps to <undefined>

[ERROR] Script failed: build_full_report.py
[ERROR] PDF Generation failed: Script failed: build_full_report.py
[CLEANUP] Deleted sources folder at: C:\Users\MSI\Desktop\projet_web\embs\v0-mother-health-app-main\backend\emotional_classification\model\pdf_generator\sources
PDF Generation completed and sources folder cleaned.
[EXIT CODE] 0
âœ… Finished: run_PDFG


==================================================
âœ… Full PDF report generated successfully.
==================================================
